!function(h){"use strict";function e(t){return t instanceof h||h.zepto&&h.zepto.isZ(t)}var i=[function(t,i){if("string"==typeof t&&0===t.indexOf("-inline-"))return this.method=i||"html",this.target=this.el=h(t.replace("-inline-","")||"<div/>"),!0},function(t){if("string"==typeof t&&0!==t.indexOf("-")){this.method="val";var i=document.createElement("input");return i.name=t,i.type="hidden",this.target=this.el=h(i),!0}},function(t){if("function"==typeof t)return this.target=!1,this.method=t,!0},function(t,i){if(e(t)&&!i)return t.is("input, select, textarea")?(this.method="val",this.target=t.on("change.liblink",this.changeHandler)):(this.target=t,this.method="html"),!0},function(t,i){if(e(t)&&("function"==typeof i||"string"==typeof i&&t[i]))return this.method=i,this.target=t,!0}];function r(e,n,t){var s=this,r=!1;if(this.changeHandler=function(t){var i=s.formatInstance.from(h(this).val());if(!1===i||isNaN(i))return h(this).val(s.lastSetValue),!1;s.changeHandlerMethod.call("",t,i)},this.el=!1,this.formatInstance=t,h.each(i,function(t,i){return!(r=i.call(s,e,n))}),!r)throw new RangeError("(Link) Invalid Link.")}function o(t){this.items=[],this.elements=[],this.origin=t}r.prototype.set=function(t){var i=Array.prototype.slice.call(arguments).slice(1);this.lastSetValue=this.formatInstance.to(t),i.unshift(this.lastSetValue),("function"==typeof this.method?this.method:this.target[this.method]).apply(this.target,i)},o.prototype.push=function(t,i){this.items.push(t),i&&this.elements.push(i)},o.prototype.reconfirm=function(t){var i;for(i=0;i<this.elements.length;i+=1)this.origin.LinkConfirm(t,this.elements[i])},o.prototype.remove=function(t){var i;for(i=0;i<this.items.length;i+=1)this.items[i].target.off(".liblink");for(i=0;i<this.elements.length;i+=1)this.elements[i].remove()},o.prototype.change=function(t){if(this.origin.LinkIsEmitting)return!1;this.origin.LinkIsEmitting=!0;var i,e=Array.prototype.slice.call(arguments,1);for(e.unshift(t),i=0;i<this.items.length;i+=1)this.items[i].set.apply(this.items[i],e);this.origin.LinkIsEmitting=!1},h.fn.Link=function(n){var s=this;if(!1===n)return s.each(function(){this.linkAPI&&(h.map(this.linkAPI,function(t){t.remove()}),delete this.linkAPI)});if(void 0===n)n=0;else if("string"!=typeof n)throw new Error("Flag must be string.");return{to:function(t,i,e){return s.each(function(){(function(t,i,e,n){0===t&&(t=this.LinkDefaultFlag),this.linkAPI||(this.linkAPI={}),this.linkAPI[t]||(this.linkAPI[t]=new o(this));var s=new r(i,e,n||this.LinkDefaultFormatter);s.target||(s.target=h(this)),s.changeHandlerMethod=this.LinkConfirm(t,s.el),this.linkAPI[t].push(s,s.el),this.LinkUpdate(t)}).call(this,n,t,i,e)})}}}}(window.jQuery||window.Zepto);